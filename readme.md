# Fail2Ban ç®¡ç†é¢æ¿

ä¸€ä¸ªä½¿ç”¨ Golang + Gin æ¡†æ¶æ„å»ºçš„ Fail2Ban ç®¡ç†é¢æ¿ï¼Œæä¾›ç”¨æˆ·å‹å¥½çš„ Web ç•Œé¢æ¥ç›‘æ§å’Œç®¡ç† Fail2Ban æœåŠ¡ã€‚

å½“å‰è¿˜åœ¨å¼€å‘ä¸­...
 
æ¬¢è¿æœ‰å…´è¶£çš„æœ‹å‹ä¸€èµ·å‚ä¸å®Œå–„ï¼




## åŠŸèƒ½ç‰¹æ€§

- ğŸ” **ç”¨æˆ·è®¤è¯**: JWT åŸºç¡€çš„ç”¨æˆ·ç™»å½•å’Œæƒé™ç®¡ç†
- ğŸ“Š **å®æ—¶ç›‘æ§**: æ˜¾ç¤ºè¢«ç¦IPåœ°å€ã€ç»Ÿè®¡ä¿¡æ¯å’Œç³»ç»ŸçŠ¶æ€
- ğŸš« **IPç®¡ç†**: æŸ¥çœ‹ã€è§£ç¦è¢«ç¦IPåœ°å€ï¼Œæ‰‹åŠ¨æ·»åŠ ç¦æ­¢IP
- âš™ï¸ **è§„åˆ™ç®¡ç†**: ç®¡ç† Fail2Ban jail é…ç½®
- ğŸ“ **æ—¥å¿—æŸ¥çœ‹**: æŸ¥çœ‹å’Œæœç´¢ Fail2Ban æ—¥å¿—
- ğŸ³ **å®¹å™¨åŒ–**: æ”¯æŒ Docker éƒ¨ç½²
- ğŸ“± **å“åº”å¼è®¾è®¡**: æ”¯æŒç§»åŠ¨è®¾å¤‡å’Œæ¡Œé¢ç«¯

## æŠ€æœ¯æ ˆ

- **åç«¯**: Golang, Gin æ¡†æ¶
- **å‰ç«¯**: HTML5, CSS3, JavaScript (Bootstrap 5)
- **æ•°æ®åº“**: SQLite (GORM)
- **è®¤è¯**: JWT
- **å®¹å™¨åŒ–**: Docker & Docker Compose

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Go 1.21+
- Fail2Ban æœåŠ¡å·²å®‰è£…å¹¶è¿è¡Œ
- Docker (å¯é€‰ï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½²)

![](img/003.png)

### æœ¬åœ°å¼€å‘

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd fail2ban_web
```

2. **å®‰è£…ä¾èµ–**
```bash
make deps
```

3. **è¿è¡Œåº”ç”¨ç¨‹åº**
```bash
make run
```

4. **è®¿é—®åº”ç”¨ç¨‹åº**
æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:8080`

é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·ï¼š
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123`

### Docker éƒ¨ç½²

1. **ä½¿ç”¨ Docker Compose (æ¨è)**
```bash
make compose-up
```

2. **æˆ–è€…ä½¿ç”¨ Docker**
```bash
make docker-build
make docker-run
```

## é¡¹ç›®ç»“æ„

```
fail2ban_web/
â”œâ”€â”€ cmd/                    # åº”ç”¨ç¨‹åºå…¥å£
â”‚   â””â”€â”€ main.go
â”œâ”€â”€ internal/               # å†…éƒ¨åŒ…
â”‚   â”œâ”€â”€ handler/           # HTTP å¤„ç†å™¨
â”‚   â”œâ”€â”€ middleware/        # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ model/            # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ service/          # ä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ web/                   # å‰ç«¯èµ„æº
â”‚   â”œâ”€â”€ static/           # é™æ€æ–‡ä»¶ (CSS, JS)
â”‚   â””â”€â”€ templates/        # HTML æ¨¡æ¿
â”œâ”€â”€ config/               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ Dockerfile           # Docker æ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml   # Docker Compose é…ç½®
â”œâ”€â”€ Makefile            # æ„å»ºè„šæœ¬
â””â”€â”€ go.mod              # Go æ¨¡å—æ–‡ä»¶
```

## API æ–‡æ¡£

### è®¤è¯æ¥å£

- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/v1/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `GET /api/v1/auth/profile` - è·å–ç”¨æˆ·ä¿¡æ¯
- `POST /api/v1/auth/refresh` - åˆ·æ–° Token

### Fail2Ban æ¥å£

- `GET /api/v1/health` - å¥åº·æ£€æŸ¥
- `GET /api/v1/stats` - è·å–ç»Ÿè®¡ä¿¡æ¯
- `GET /api/v1/system-info` - è·å–ç³»ç»Ÿä¿¡æ¯
- `GET /api/v1/banned-ips` - è·å–è¢«ç¦IPåˆ—è¡¨
- `POST /api/v1/unban` - è§£ç¦IP
- `POST /api/v1/ban` - æ‰‹åŠ¨ç¦æ­¢IP
- `GET /api/v1/jails` - è·å–jailåˆ—è¡¨
- `GET /api/v1/logs` - è·å–æ—¥å¿—

## é…ç½®

åº”ç”¨ç¨‹åºæ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ï¼š

| å˜é‡å | é»˜è®¤å€¼ | æè¿° |
|--------|---------|------|
| `PORT` | `8080` | æœåŠ¡å™¨ç«¯å£ |
| `HOST` | `0.0.0.0` | æœåŠ¡å™¨åœ°å€ |
| `GIN_MODE` | `release` | Gin è¿è¡Œæ¨¡å¼ |
| `DB_PATH` | `./fail2ban_web.db` | æ•°æ®åº“æ–‡ä»¶è·¯å¾„ |
| `JWT_SECRET` | `your-secret-key...` | JWT å¯†é’¥ |
| `JWT_EXPIRE_TIME` | `24` | JWT è¿‡æœŸæ—¶é—´(å°æ—¶) |
| `FAIL2BAN_LOG_PATH` | `/var/log/fail2ban.log` | Fail2Ban æ—¥å¿—è·¯å¾„ |

## å¼€å‘å‘½ä»¤

```bash
# æ„å»ºåº”ç”¨ç¨‹åº
make build

# è¿è¡Œåº”ç”¨ç¨‹åº
make run

# è¿è¡Œæµ‹è¯•
make test

# ä»£ç æ ¼å¼åŒ–
make fmt

# çƒ­é‡è½½å¼€å‘
make dev

# æ„å»ºæ‰€æœ‰å¹³å°ç‰ˆæœ¬
make build-all

# Docker ç›¸å…³
make docker-build
make docker-run
make compose-up

# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make help
```

## éƒ¨ç½²æ³¨æ„äº‹é¡¹

1. **æƒé™è¦æ±‚**: åº”ç”¨ç¨‹åºéœ€è¦è®¿é—® Fail2Ban å‘½ä»¤è¡Œå·¥å…·å’Œæ—¥å¿—æ–‡ä»¶çš„æƒé™
2. **ç½‘ç»œå®‰å…¨**: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·æ›´æ”¹é»˜è®¤çš„ JWT å¯†é’¥
3. **é˜²ç«å¢™**: ç¡®ä¿ 8080 ç«¯å£åœ¨é˜²ç«å¢™ä¸­å·²å¼€æ”¾
4. **SSL/TLS**: ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨åå‘ä»£ç† (Nginx) é…ç½® HTTPS

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·åˆ›å»ºä¸€ä¸ª Issue æˆ–æŸ¥çœ‹æ–‡æ¡£ã€‚


![](img/451759627900_.pic.jpg)
